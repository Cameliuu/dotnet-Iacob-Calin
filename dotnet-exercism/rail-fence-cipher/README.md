I actually spent almost 3 hours solving this.
As painful as it was, it was equally fun.